"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5975],{7089:function(e,n){n.Z={src:"/_next/static/media/cancel (1).4d362383.png",height:512,width:512,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAHlBMVEXiTUznbGzbRUTZQ0LWREP52tr2xMRMaXHhTEvgR0YAwLdjAAAACXRSTlP8/rUq9v74APHtnc+LAAAACXBIWXMAAA+SAAAPkgEEqH6gAAAANElEQVQImUWLQQ4AIAzCGEwH//+wJh68NWmLEW1qICOBBWJXbRBOrVXpD0+FL04LI3bf/QAolAEfnj5/lgAAAABJRU5ErkJggg=="}},6555:function(e,n){n.Z={src:"/_next/static/media/send.d6060f6c.png",height:640,width:640,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEVMaXEAAAAFBQUbGxtubm5nZ2dWVlZ8fHwAAAAEBATS0tL///9mZmaEGkfXAAAACnRSTlMABmt94tnK2US5Yu1KsQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAClJREFUCJljYAABRiZOCMXOwwGiWLm4mBkYmFm4uLnZGJEYcCmEYqh2ACDzAO8PIwmSAAAAAElFTkSuQmCC"}},5975:function(e,n,t){t.r(n);var r=t(4051),i=t.n(r),s=t(5893),l=t(7294),a=t(9669),o=t.n(a),c=t(2165),u=(t(7089),t(5675)),d=t(6555);function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function h(e,n,t,r,i,s,l){try{var a=e[s](l),o=a.value}catch(c){return void t(c)}a.done?n(o):Promise.resolve(o).then(r,i)}function m(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var s=e.apply(n,t);function l(e){h(s,r,i,l,a,"next",e)}function a(e){h(s,r,i,l,a,"throw",e)}l(void 0)}))}}function p(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){p(e,n,t[n])}))}return e}function A(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return f(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.default=function(e){var n=e.allMessages,t=e.message,r=e.sendMessage,a=e.setMessage,f=e.setActiveChat,h=e.activeChat,p=e.onlineUsers,x=e.arrivalMessage,v=(0,l.useState)([]),b=v[0],j=v[1],y=(0,l.useRef)(null),w=(0,l.useState)(!1),C=(w[0],w[1],(0,l.useState)(0)),S=C[0],k=C[1],E=(0,l.useState)([]),I=E[0],N=E[1],U=(0,l.useState)(""),R=U[0],M=U[1],O=(0,l.useState)(""),W=O[0],L=O[1],_=(0,l.useState)(!1),T=_[0],B=_[1],D=(0,l.useState)([]),F=D[0],J=D[1];(0,l.useEffect)((function(){var e=function(){k(window.innerWidth)};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]);var z=!1;S<800&&(z=!0),(0,l.useEffect)((function(){var e=function(){var e=m(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("http://dreamweb.runflare.run/conversation/Admin",{withCredentials:!0}).then((function(e){j(e.data)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var P=p&&p.find((function(e){return e.userId===h}))||null;(0,l.useEffect)((function(){var e=A(n).filter((function(e){return e.conversationId===h}));N(e)}),[h]),(0,l.useEffect)((function(){if(x){var e=A(n).filter((function(e){return e.conversationId===h}));x.sender===h&&(e.push(x),N(e))}}),[x]),(0,l.useEffect)((function(){var e=b&&b.find((function(e){return e.members[0]===x.sender}));e&&0!==e.length||x&&j([{_id:"edrfgfd",members:[x.sender,"Admin-hrttrhthr%00"]}].concat(A(b)))}),[x]);var Z=function(){var e=m(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={conversationId:R,messages:W},e.prev=1,e.next=4,o().post("http://dreamweb.runflare.run/adminRoute/deleteChat",n,{withCredentials:!0}).then((function(e){alert(e.data),B(!1),J(F.filter((function(e){return e.chat!==W}))),localStorage.setItem("seen",JSON.stringify(F)),j(b.filter((function(e){return e._id!==R})))}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),B(!1);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[I]);var X=function(){var e=m(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=F.find((function(e){return e.chat===t})))&&(J(F.map((function(e){return e.chat!==t?e:g({},e,{seen:n.filter((function(e){return e.conversationId===t})).length})}))),localStorage.setItem("seen",JSON.stringify(F))),r||(J(A(F).concat([{chat:t,seen:n.filter((function(e){return e.conversationId===t})).length}])),localStorage.setItem("seen",JSON.stringify(F)));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){var e=localStorage.getItem("seen");e&&J(JSON.parse(e))}),[]);var G=function(e){var t=F.find((function(n){return n.chat===e}));return t?n.filter((function(n){return n.conversationId===e})).length-t.seen:t?void 0:n.filter((function(n){return n.conversationId===e})).length};return(0,s.jsxs)("div",{className:"Admin-Chat",style:z?{flexFlow:"column"}:null,children:[T&&(0,s.jsx)("div",{onClick:function(){return B(null)},id:"backDrop",children:"hello"}),T&&(0,s.jsxs)("div",{className:"secc-comment",children:[(0,s.jsx)("img",{src:"/uploads/warning.png",alt:""}),(0,s.jsx)("h1",{children:"\u0622\u06cc\u0627 \u0627\u06cc\u0646 \u06af\u0641\u062a\u06af\u0648 \u062d\u0630\u0641 \u0634\u0648\u062f \u061f"}),(0,s.jsx)("button",{style:{background:"#fe1919"},onClick:Z,children:" \u062d\u0630\u0641 \u06af\u0641\u062a\u06af\u0648"})]}),!0!==z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"allConversations",children:[!b.errMessage&&b&&b.map((function(e){return(0,s.jsxs)("div",{style:h===e.members[0]?{background:"silver",color:"White"}:null,onClick:function(){f(e.members[0]),X(e.members[0]),M(e._id)},children:[p&&p.find((function(n){return n.userId===e.members[0]}))&&(0,s.jsx)("label",{})||(0,s.jsx)("label",{style:{background:"red"}}),!F.find((function(n){return n.chat===e.members[0]}))&&(0,s.jsx)("b",{children:"New"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("img",{src:"/uploads/user.png"}),(0,s.jsx)("p",{children:e.members[0]&&e.members[0].length>22?" ".concat(e.members[0].substring(0,18),"..."):"".concat(e.members[0])})]}),(0,s.jsx)("circle",{children:G(e.members[0])})]},e._id)})),b&&0===b.length&&(0,s.jsxs)("p",{style:{width:"100%",display:"flex",flexFlow:"column",alignItems:"center"},children:[(0,s.jsx)("h1",{style:{width:"100%",textAlign:"center"},children:" ! No Chat Yet "}),(0,s.jsx)(u.default,{width:100,height:100,src:"/images/noChat.png",alt:"no-chat"})]})]}),(0,s.jsxs)("div",{style:{background:"silver",borderRadius:"10px"},className:"A-messages",children:[(0,s.jsxs)("div",{style:{position:"relative"},className:"A-profile",children:[(0,s.jsx)("img",{src:"/uploads/user.png"}),(0,s.jsxs)("div",{style:{display:"flex",flexFlow:"column",justifyContent:"space-evenly",height:"10%"},children:[(0,s.jsx)("p",{style:{fontWeight:"600"},children:h&&h||"User"}),h&&(0,s.jsx)("p",{style:P?{color:"green",marginTop:"-20px"}:{color:"red",marginTop:"-20px"},children:P?"online":"offline"})]}),h&&(0,s.jsx)("button",{onClick:function(){B(!0),L(h)},style:{position:"absolute",left:"5%",bottom:"26%",fontWeight:"600",background:"red",color:"white",border:"none",borderRadius:"10px",padding:"10px"},children:"Delete Chat"})]}),(0,s.jsx)("div",{className:"chat-room",children:(0,s.jsxs)("div",{children:[h&&n&&I&&I.map((function(e){return(0,s.jsxs)("div",{style:e&&"Admin-hrttrhthr%00"!==e.sender?{alignItems:"flex-end"}:null,children:[(0,s.jsx)("p",{style:e&&"Admin-hrttrhthr%00"!==e.sender?{backgroundColor:"#78e6f3"}:null,children:e&&e.text}),(0,s.jsx)("label",{children:(0,c.WU)(e&&e.createdAt)})]},e&&e._id)})),!h&&(0,s.jsx)("h1",{style:{margin:"30% auto",zIndex:"1"},children:"!Welcome to LiveChat"}),b&&(0,s.jsx)("div",{ref:y})]})}),(0,s.jsxs)("form",{style:{marginTop:"-2px",borderRadius:"10px"},className:"A-input",children:[(0,s.jsx)("input",{value:t,onChange:function(e){return a(e.target.value)},placeholder:"\u067e\u06cc\u0627\u0645 \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f..."}),(0,s.jsx)("button",{onClick:r,children:(0,s.jsx)(u.default,{width:30,height:30,src:d.Z,alt:"send.png"})})]})]})," "]}),!0===z&&(0,s.jsxs)(s.Fragment,{children:[h&&(0,s.jsxs)("div",{style:{background:"silver",borderRadius:"10px",width:"100%"},className:"A-messages",children:[(0,s.jsxs)("div",{className:"A-profile",style:{position:"relative"},children:[(0,s.jsx)("img",{src:"/uploads/user.png"}),(0,s.jsx)("img",{src:"/images/send.png",onClick:function(){return f(null)},style:{position:"absolute",cursor:"pointer",left:"0px",top:"0px",width:"28px",height:"28px",borderRadius:"0px"}}),(0,s.jsxs)("div",{style:{display:"flex",flexFlow:"column",justifyContent:"space-evenly",height:"10%"},children:[(0,s.jsx)("p",{style:{fontWeight:"600"},children:h&&h||"User"}),h&&(0,s.jsx)("p",{style:P?{color:"green",marginTop:"-20px"}:{color:"red",marginTop:"-20px"},children:P?"online":"offline"})]}),(0,s.jsx)("button",{style:{background:"#fe1919",position:"absolute",left:"1%",padding:"5px",bottom:"2%",borderRadius:"10px",color:"white",border:"none"},onClick:function(){B(!0),L(h)},children:" Delete "})]}),h&&(0,s.jsx)("div",{className:"chat-room",children:(0,s.jsxs)("div",{children:[h&&n&&I&&I.map((function(e){return(0,s.jsxs)("div",{style:e&&"Admin-hrttrhthr%00"!==e.sender?{alignItems:"flex-end"}:null,children:[(0,s.jsx)("p",{style:e&&"Admin-hrttrhthr%00"!==e.sender?{backgroundColor:"#78e6f3"}:null,children:e&&e.text}),(0,s.jsx)("label",{children:(0,c.WU)(e&&e.createdAt)})]},e&&e._id)})),!h&&(0,s.jsx)("h1",{style:{margin:"30% auto",zIndex:"1"},children:"!Welcome to LiveChat"}),b&&(0,s.jsx)("div",{ref:y})]})}),(0,s.jsxs)("form",{style:{marginTop:"-2px",borderRadius:"10px"},className:"A-input",children:[(0,s.jsx)("input",{value:t,onChange:function(e){return a(e.target.value)},placeholder:"\u067e\u06cc\u0627\u0645 \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f..."}),(0,s.jsx)("button",{onClick:r,children:(0,s.jsx)(u.default,{width:30,height:30,src:d.Z,alt:"send.png"})})]})]}),!h&&(0,s.jsxs)("div",{style:{width:"100%"},className:"allConversations",children:[!b.errMessage&&b&&b.map((function(e){return(0,s.jsxs)("div",{style:h===e.members[0]?{background:"silver",color:"White"}:null,onClick:function(){f(e.members[0]),X(e.members[0]),M(e._id)},children:[p&&p.find((function(n){return n.userId===e.members[0]}))&&(0,s.jsx)("label",{})||(0,s.jsx)("label",{style:{background:"red"}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("img",{src:"/uploads/user.png"}),(0,s.jsx)("p",{children:e.members[0].length>24?"".concat(e.members[0].substring(0,24),"..."):"".concat(e.members[0])})]}),(0,s.jsx)("circle",{style:{margin:"10px"},children:G(e.members[0])})]},e._id)})),b&&0===b.length&&(0,s.jsxs)("p",{style:{width:"100%",display:"flex",flexFlow:"column",height:"100%",justifyContent:"center",alignItems:"center"},children:[(0,s.jsx)("h1",{style:{width:"100%",textAlign:"center"},children:" ! Sorry No Chat Yet "}),(0,s.jsx)(u.default,{width:150,height:150,src:"/images/noChat.png",alt:"no-chat"})]})]})]})]})}},2165:function(e,n,t){t.d(n,{WU:function(){return c}});var r=["second","minute","hour","day","week","month","year"];var i=["\u79d2","\u5206\u949f","\u5c0f\u65f6","\u5929","\u5468","\u4e2a\u6708","\u5e74"];var s={},l=function(e,n){s[e]=n},a=[60,60,24,7,365/7/12,12];function o(e){return e instanceof Date?e:!isNaN(e)||/^\d+$/.test(e)?new Date(parseInt(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(e))}var c=function(e,n,t){var r=function(e,n){return(+(n?o(n):new Date)-+o(e))/1e3}(e,t&&t.relativeDate);return function(e,n){for(var t=e<0?1:0,r=e=Math.abs(e),i=0;e>=a[i]&&i<a.length;i++)e/=a[i];return(e=Math.floor(e))>(0===(i*=2)?9:1)&&(i+=1),n(e,i,r)[t].replace("%s",e.toString())}(r,function(e){return s[e]||s.en_US}(n))};l("en_US",(function(e,n){if(0===n)return["just now","right now"];var t=r[Math.floor(n/2)];return e>1&&(t+="s"),[e+" "+t+" ago","in "+e+" "+t]})),l("zh_CN",(function(e,n){if(0===n)return["\u521a\u521a","\u7247\u523b\u540e"];var t=i[~~(n/2)];return[e+" "+t+"\u524d",e+" "+t+"\u540e"]}))}}]);